import Data.List as L
import Data.Map as M

infixl 0 |>
x |> f = f x

start  = (0,0)
target = (length (head problem) - 1, length problem - 1)

coords = [ (x,y) 
         | (y,row) <- zip [0..] problem
         , (x,c)   <- zip [0..] row 
         , c == "#"
         ]

problem = maze2

eg1 = [[" "," ","#"," ","#"," ","#"," ","#"," "," "," "," "," "," ","#"," ","#"," "," "," "," "," ","#"," "],
       [" "," "," ","#"," "," "," "," "," "," "," ","#","#"," ","#"," ","#"," ","#"," "," "," "," "," ","#"],
       [" "," "," "," "," "," "," "," "," "," ","#"," "," ","#"," "," "," ","#"," "," "," ","#","#","#"," "],
       [" ","#"," "," "," "," ","#"," "," "," "," "," ","#","#","#"," "," "," "," "," "," "," "," "," ","#"],
       [" "," "," ","#"," "," "," "," "," "," "," ","#","#"," "," "," ","#"," "," "," ","#"," ","#"," "," "],
       ["#"," "," "," "," "," ","#"," ","#","#"," "," ","#"," "," ","#"," "," "," "," "," ","#"," "," "," "],
       ["#"," ","#"," "," "," "," "," ","#"," ","#"," "," "," "," ","#"," "," ","#"," "," "," "," "," "," "],
       ["#"," ","#"," ","#","#","#"," "," "," ","#"," "," ","#","#"," "," "," "," ","#"," ","#"," "," "," "],
       [" "," ","#"," "," "," "," "," "," ","#"," "," ","#"," "," "," "," "," "," "," ","#"," "," "," "," "],
       [" "," ","#"," "," ","#"," ","#","#"," ","#"," "," "," "," "," "," "," ","#"," "," "," "," ","#"," "],
       [" ","#"," "," "," "," "," ","#","#"," "," "," "," ","#","#","#","#"," ","#"," "," ","#"," "," ","#"],
       [" "," "," "," "," "," "," ","#"," "," "," ","#"," "," "," ","#","#","#"," "," "," ","#"," "," "," "],
       ["#"," "," "," "," ","#"," ","#","#"," "," "," "," "," "," ","#"," "," "," "," ","#"," "," "," ","#"],
       ["#","#"," ","#","#","#","#"," "," "," "," "," "," ","#"," "," "," "," "," "," "," "," ","#","#"," "],
       [" "," "," "," "," "," ","#","#"," "," "," "," "," ","#"," "," "," ","#"," "," "," "," "," "," ","#"],
       [" ","#"," "," "," "," ","#"," ","#"," ","#"," ","#"," ","#","#"," ","#"," "," "," "," "," "," ","#"],
       [" "," "," ","#"," ","#","#"," "," "," ","#"," "," ","#","#"," "," ","#"," "," "," ","#"," ","#"," "],
       [" ","#"," ","#"," "," "," "," "," ","#"," "," ","#"," ","#","#","#","#"," "," "," ","#"," "," ","#"],
       ["#"," "," "," "," "," "," "," "," "," "," "," "," "," ","#"," "," "," "," "," "," "," "," "," ","#"],
       [" ","#"," ","#"," ","#"," ","#","#","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," ","#"," "],
       [" "," "," "," ","#"," "," "," "," "," ","#"," ","#"," "," ","#"," "," "," "," ","#"," "," "," "," "],
       [" "," "," ","#"," "," ","#"," "," "," "," "," ","#","#"," "," "," "," ","#"," "," "," "," "," "," "],
       ["#"," "," "," "," "," "," "," ","#"," "," "," ","#"," "," "," "," "," "," "," "," "," "," ","#","#"],
       [" ","#"," "," ","#"," "," ","#","#","#"," "," ","#"," ","#","#"," ","#"," ","#"," "," "," "," "," "],
       [" "," "," "," "," "," "," "," ","#"," "," "," ","#"," "," "," ","#","#"," "," "," ","#"," ","#"," "]]

eg2 = 
  [[" "," ","#"," ","#"," "," "," "," ","#"," "," "," ","#"," "," "," ","#"," "," "," "," "," "," "," "],
   [" "," "," ","#"," "," ","#"," ","X"," "," "," "," "," "," ","#"," "," "," "," "," "," ","#"," ","#"],
   [" "," "," ","#","#"," ","#","#"," "," "," "," "," ","#"," "," "," "," "," ","#"," "," "," "," "," "],
   [" "," "," "," "," "," "," ","#","#"," "," "," "," "," "," "," "," ","#"," "," ","#"," "," ","#"," "],
   [" "," "," "," "," ","#","#"," "," "," "," "," "," "," "," "," "," ","#"," "," "," "," ","#"," "," "],
   [" "," "," "," ","#","#"," "," "," "," "," "," "," "," ","#"," "," "," "," "," "," ","#"," "," "," "],
   [" "," "," ","#"," "," "," "," "," "," "," "," "," "," "," ","#"," "," ","#"," ","#"," ","#"," "," "],
   ["#","#","#"," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," ","#","#"," "," "," ","#"," "],
   ["#"," "," "," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"," ","#"," "," "],
   [" "," "," "," ","#"," ","#"," "," "," "," "," ","#"," "," "," "," "," ","#"," "," "," "," ","#"," "],
   [" "," ","#","#","#"," "," "," ","#"," "," "," "," "," "," "," "," ","#"," ","#"," ","#"," "," "," "],
   [" "," "," "," "," "," "," "," ","#","#"," "," "," "," "," "," "," "," "," "," ","#"," "," "," "," "],
   [" "," "," ","#"," "," "," "," "," "," ","#"," ","#"," ","#"," "," "," "," "," ","#","#"," "," ","#"],
   [" "," "," "," "," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," "," ","#"," "," "," "," "],
   [" "," ","#"," "," "," "," "," ","#","#","#"," ","#"," "," "," "," ","#"," "," "," "," "," "," ","#"],
   ["#"," "," "," ","#"," "," "," "," "," ","#","#"," "," "," "," "," ","#"," "," "," "," ","#"," "," "],
   [" "," "," "," "," "," ","#"," ","#"," ","#"," "," ","#"," "," "," "," "," "," "," "," "," "," "," "],
   [" "," ","#"," "," "," "," "," ","#"," "," "," "," "," ","#","#"," "," ","#"," ","#","#","#"," "," "],
   ["#"," "," ","#","#"," "," "," "," ","#"," "," "," ","#"," "," "," "," "," ","#","#","#"," "," "," "],
   [" "," "," "," "," "," "," "," "," "," ","#","#"," "," "," "," "," ","#"," "," "," "," "," "," "," "],
   ["#","#","#","#","#"," "," "," "," "," "," "," "," "," ","#","#","#"," ","#"," ","#"," ","#"," ","#"],
   [" ","#"," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," ","#"," "," "," "," "," ","#"," "],
   ["#"," "," "," "," "," "," ","#"," "," ","#"," "," ","#","#","#"," "," "," "," "," ","#"," "," "," "],
   [" "," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","#"," "," "," "," "],
   ["#"," "," "," "," ","#","#"," ","#"," "," "," "," "," "," "," "," ","#"," ","#","#"," ","#"," "," "]]

-- [(74,("DRDDRRDDRRRRRRDDRRRRRRUURRRRDDRRDDDDDDRRRRDDDDRRRRDDDDDDRRRRRRDDDDRRRRDDDR",(40,30)))]                                         
maze1 = [[" "," ","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
         ["#"," ","#"," ","#"," ","#"," "," "," "," "," "," "," ","#"," "," "," "," "," ","#"," ","#"," "," "," "," "," "," "," "," "," ","#"," "," "," "," "," "," "," ","#"],
         ["#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#","#","#","#","#"],
         ["#"," "," "," "," "," "," "," "," "," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","#"," "," "," "," "," ","#"," ","#"," ","#"," ","#"],
         ["#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#","#","#","#","#"," ","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"," ","#"," ","#"],
         ["#"," ","#"," ","#"," "," "," "," "," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," "," "," "," "," ","#"],
         ["#"," ","#","#","#"," ","#","#","#","#","#","#","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#"],
         ["#"," "," "," ","#"," "," "," "," "," "," "," "," "," ","#"," "," "," ","#"," "," "," "," "," "," "," ","#"," "," "," ","#"," "," "," ","#"," ","#"," "," "," ","#"],
         ["#","#","#"," ","#","#","#","#","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#"],
         ["#"," "," "," "," "," "," "," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"],
         ["#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#"],
         ["#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," "," "," "," "," ","#"," ","#"," "," "," "," "," "," "," ","#"," ","#"," ","#"],
         ["#","#","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#","#","#","#","#"," ","#","#","#"," ","#","#","#"," ","#"],
         ["#"," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," "," "," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," "," "," ","#"," ","#"," ","#"," ","#"],
         ["#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#"],
         ["#"," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," ","#"," ","#"," ","#"],
         ["#"," ","#"," ","#","#","#","#","#","#","#"," ","#","#","#"," ","#","#","#","#","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"],
         ["#"," ","#"," "," "," "," "," "," "," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," ","#"," ","#"," ","#"," "," "," "," "," "," "," "," "," ","#"],
         ["#","#","#"," ","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#","#","#"," ","#","#","#","#","#"," ","#","#","#"," ","#","#","#"," ","#","#","#"," ","#","#","#"],
         ["#"," "," "," ","#"," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"],
         ["#"," ","#"," ","#","#","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#"],
         ["#"," ","#"," ","#"," "," "," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"," ","#"," "," "," ","#"," ","#"," "," "," ","#"," ","#"," ","#"],
         ["#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#"],
         ["#"," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," "," "," "," "," "," "," ","#"," ","#"," ","#"," ","#"," ","#"],
         ["#"," ","#","#","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#"],
         ["#"," "," "," ","#"," ","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," "," "," ","#"," ","#"," "," "," "," "," "," "," ","#"," ","#"],
         ["#"," ","#","#","#","#","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#","#","#"," ","#","#","#"],
         ["#"," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," "," "," ","#"," "," "," ","#"],
         ["#"," ","#","#","#","#","#","#","#","#","#","#","#"," ","#","#","#"," ","#","#","#","#","#","#","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#"],
         ["#"," "," "," "," "," "," "," "," "," "," "," ","#"," "," "," ","#"," "," "," "," "," ","#"," "," "," "," "," ","#"," ","#"," "," "," ","#"," "," "," ","#"," "," "],
         ["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"," "]]


-- [(104,("RDRRRRDDRRRRRRRRRRRRRRDDDDDDRRDDDDDDDDDDRRRRRRDDRRDDRRDDRRDDDDRRRRRRUURRDDDDRRDDRRRRRRRRRRDDDDRRRRRRDDDR",(60,40)))]
maze2 = [[" "," ","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"],
         ["#"," "," "," "," "," "," "," ","#"," "," "," "," "," "," "," ","#"," "," "," "," "," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," "," "," "," "," ","#"," "," "," "," "," ","#"," ","#"," "," "," "," "," "," "," "," "," ","#"],
         ["#"," ","#","#","#","#","#","#","#"," ","#","#","#","#","#","#","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#","#","#","#","#"," ","#","#","#","#","#"," ","#"," ","#","#","#","#","#","#","#","#","#"],
         ["#"," "," "," "," "," "," "," "," "," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","#"," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," ","#"," ","#"," ","#"],
         ["#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#","#","#","#","#","#","#"," ","#","#","#","#","#","#","#","#","#","#","#","#","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#","#","#"," ","#","#","#","#","#","#","#"," ","#"," ","#"],
         ["#"," "," "," "," "," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," "," "," ","#"," "," "," "," "," "," "," "," "," "," "," ","#"],
         ["#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#","#","#","#","#"," ","#"," ","#"," ","#","#","#","#","#","#","#","#","#"," ","#"," ","#","#","#","#","#","#","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#"],
         ["#"," ","#"," "," "," ","#"," "," "," "," "," "," "," "," "," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," "," "," "," "," "," "," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"],
         ["#"," ","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"],
         ["#"," ","#"," ","#"," "," "," "," "," ","#"," ","#"," "," "," ","#"," "," "," "," "," "," "," "," "," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," "," "," "," "," ","#"," ","#"," ","#"," ","#"," "," "," ","#"],
         ["#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#"," ","#","#","#","#","#","#","#"," ","#","#","#"," ","#","#","#"," ","#","#","#","#","#","#","#"," ","#"," ","#","#","#","#","#"," ","#"," ","#","#","#"," ","#"," ","#"],
         ["#"," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","#"," ","#"," ","#"," "," "," "," "," ","#"," ","#"," ","#"," ","#"],
         ["#","#","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#","#","#","#","#"," ","#","#","#"," ","#"," ","#","#","#","#","#"," ","#","#","#","#","#"],
         ["#"," "," "," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," ","#"," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," "," "," "," "," ","#"," ","#"," ","#"],
         ["#"," ","#","#","#","#","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#","#","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#"],
         ["#"," ","#"," "," "," "," "," ","#"," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," "," "," "," "," "," "," "," "," "," "," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," ","#"],
         ["#","#","#","#","#"," ","#","#","#","#","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#","#","#","#","#","#","#"," ","#","#","#","#","#"," ","#","#","#"," ","#","#","#"],
         ["#"," "," "," "," "," ","#"," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," "," "," "," "," ","#"," ","#"," "," "," "," "," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," ","#"," "," "," "," "," ","#"," "," "," ","#"],
         ["#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#"," ","#","#","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#"," ","#"," ","#","#","#","#","#","#","#","#","#"," ","#"," ","#"," ","#"," ","#"],
         ["#"," ","#"," "," "," "," "," ","#"," "," "," "," "," ","#"," ","#"," ","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," "," "," ","#"," "," "," ","#"," ","#"," ","#"," ","#"],
         ["#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#","#","#","#","#","#","#"," ","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#","#","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#","#","#","#","#"],
         ["#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," ","#"," ","#"," ","#"," "," "," "," "," "," "," ","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"],
         ["#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#","#","#","#","#","#","#"," ","#","#","#"," ","#","#","#"," ","#"],
         ["#"," ","#"," ","#"," ","#"," "," "," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"," ","#"],
         ["#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#","#","#","#","#"," ","#"," ","#"," ","#","#","#","#","#","#","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#"," ","#","#","#","#","#","#","#","#","#","#","#","#","#"],
         ["#"," ","#"," ","#"," ","#"," ","#"," "," "," "," "," ","#"," ","#"," "," "," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," ","#"," ","#"," "," "," ","#"," "," "," ","#"," "," "," "," "," "," "," "," "," "," "," ","#"," "," "," ","#"],
         ["#"," ","#"," ","#","#","#"," ","#","#","#"," ","#","#","#"," ","#","#","#"," ","#","#","#","#","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#","#","#"," ","#","#","#","#","#"," ","#","#","#"],
         ["#"," ","#"," ","#"," "," "," ","#"," "," "," "," "," "," "," ","#"," ","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," "," "," ","#"," ","#"," ","#"," "," "," ","#"," "," "," "," "," ","#"," ","#"," "," "," "," "," "," "," "," "," ","#"],
         ["#"," ","#","#","#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#","#","#"," ","#","#","#"],
         ["#"," ","#"," "," "," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," "," "," ","#"," ","#"," ","#"," "," "," ","#"],
         ["#"," ","#"," ","#","#","#","#","#","#","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#","#","#"," ","#"," ","#"," ","#","#","#"],
         ["#"," ","#"," ","#"," "," "," "," "," "," "," "," "," ","#"," "," "," "," "," "," "," ","#"," "," "," "," "," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," "," "," "," "," ","#"," ","#"," "," "," ","#"],
         ["#","#","#"," ","#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#","#","#","#","#","#","#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#"],
         ["#"," "," "," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," ","#"," "," "," "," "," ","#"," "," "," ","#"," ","#"," "," "," "," "," ","#"," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," "," "," ","#"," "," "," ","#"],
         ["#","#","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#","#","#","#","#","#","#"," ","#","#","#","#","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#","#","#","#","#"," ","#"],
         ["#"," "," "," ","#"," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," ","#"," ","#"," "," "," "," "," ","#"," "," "," "," "," ","#"," "," "," ","#"," "," "," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," ","#"],
         ["#","#","#"," ","#","#","#"," ","#","#","#","#","#"," ","#","#","#","#","#"," ","#","#","#","#","#"," ","#"," ","#","#","#"," ","#","#","#","#","#"," ","#","#","#"," ","#","#","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#"," ","#"],
         ["#"," "," "," ","#"," "," "," ","#"," "," "," "," "," "," "," "," "," ","#"," "," "," "," "," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," "," ","#"],
         ["#"," ","#"," ","#","#","#"," ","#","#","#"," ","#","#","#"," ","#","#","#"," ","#"," ","#","#","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#"," ","#","#","#","#","#"," ","#","#","#"," ","#","#","#","#","#"," ","#","#","#","#","#"],
         ["#"," ","#"," ","#"," "," "," "," "," ","#"," ","#"," "," "," "," "," ","#"," ","#"," "," "," ","#"," ","#"," ","#"," ","#"," "," "," "," "," ","#"," "," "," ","#"," "," "," "," "," "," "," ","#"," "," "," "," "," ","#"," "," "," "," "," ","#"],
         ["#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#","#"," "," "]]

----------------------------------------


type Coord = (Int,Int)
type State = (String, Coord)

state0 :: State
state0 = ("", start)

next (x,y)
 = [ candidate
   | candidate@(step, pt@(nx, ny)) <- [ ('D', (x,     y+1))
                                      , ('R', (x + 1, y)  ) ] 
   , pt `notElem` coords
   , 0 <= nx && nx <= fst target
   , 0 <= ny && ny <= snd target
   ] 

next_path (p,pt) = [ (d:p, xy) | (d,xy) <- next pt ]

data Gtree a 
  = Node { root :: a,
           children :: [Gtree a] 
         }
    deriving Show


statespace :: (s -> [s]) -> s -> Gtree s
statespace f s = Node s (fmap (statespace f) $ f s)


brfs :: [Gtree a] -> [a]
brfs ts = fmap root ts ++ brfs (ts |> fmap children |> concat)

run_it :: State -> [State]
run_it s = [ (p,pt) | (p,pt) <- brfs [statespace next_path s], pt == target ]

t_brfs = run_it state0 |> take 10 |> fmap show |> unlines |> putStr

----------------------------------------


type StateH = (Int, State)

full_next (p,(x,y))
 = [ (step:p, pt)
   | candidate@(step, pt@(nx, ny)) <- [ ('D', (x,     y+1))
                                      , ('R', (x + 1, y)  ) 
                                      , ('U', (x    , y-1)) 
                                      , ('L', (x - 1, y)  ) ] 
   , pt `notElem` coords
   , 0 <= nx && nx <= fst target
   , 0 <= ny && ny <= snd target
   ] 

next_val_state (_,s) = [ (length p + manhattan_dist xy target, (p,xy))  | (p, xy) <- full_next s ]

manhattan_dist (a,b) (x,y) =  abs (a - x) + abs (b - y)

goal (_,(_,pt)) = pt == target 


-- bestfs :: [StateH] -> [StateH] -> [StateH]
bestfs seen [] = []
bestfs seen (s:ss)
 | (snd $ snd s) `elem` seen = bestfs seen ss 
 | goal s        = s : bestfs ((snd $ snd s) : seen) ss
 | otherwise     = bestfs ((snd $ snd s) : seen) $ sort $ next_val_state s ++ ss 

t_best pt = bestfs [] [(0,("",pt))] |> take 10 |> fmap show |> unlines |> putStr


----------------------------------------
-- more abstractly
-- best-first traversal of (poss repeating) state space

bfs_space = statespace next_val_state (0, state0)

bfs_traverse :: (s -> s -> Ordering) -> (s -> [s] -> Bool) -> [s] -> [Gtree s] -> [s]
bfs_traverse ordering already_seen visited [] 
 = []
bfs_traverse ordering already_seen visited ((Node s cs): gts)
 | already_seen s visited = bfs_traverse ordering already_seen visited gts
 | otherwise              = s : bfs_traverse ordering already_seen (s : visited) new_queue
 where new_queue = sortBy (\(Node a _) (Node b _) -> ordering a b) $ cs ++ gts

t2 = bfs_traverse (\a b -> fst a `compare` fst b) 
                  (\(_,(_,xy)) pts -> or [ xy == pt | (_,(_,pt)) <- pts] )
                  []
                  [bfs_space]
     |> L.filter goal 


